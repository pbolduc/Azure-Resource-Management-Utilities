#
# assoicate a certificate with a application (client)
#

$certificatePath = "<client-certificate>.cer"
$applicationClientId = "<client-id>"

# associate the certificate with your AAD account
Connect-MsolService

$cer = New-Object System.Security.Cryptography.X509Certificates.X509Certificate 
$cer.Import($certificatePath) 
$binCert = $cer.GetRawCertData() 
$credValue = [System.Convert]::ToBase64String($binCert); 
New-MsolServicePrincipalCredential -AppPrincipalId $applicationClientId -Type asymmetric -Value $credValue -Usage verify


#
# grant the application  (client) identity access to the resource group
#
$applicationClientId = "<client-id>"
New-AzureRmRoleAssignment ` 
   -ObjectId $applicationClientId ` 
   -RoleDefinitionName "Contributor" ` 
   -Scope "/subscriptions/<subscription-id>/resourceGroups/<resource-group>" 